/**
 * Copyright (c) 2014, 2017, Oracle and/or its affiliates.
 * The Universal Permissive License (UPL), Version 1.0
 */
"use strict";
define(["ojs/ojcore","promise","ojs/ojcustomelement","ojs/ojcomposite-knockout"],function(a){a.bc={};a.bc.kh=Object.create(a.$.kh);a.tc.Gd(a.bc.kh,{zM:function(b){b.setProperty=function(b,c){var f=a.rc.bn(b),g=a.$.Ta(this),k=a.$.Hm(b,a.$.Pk(g));f||!k?this[b]=c:(f=this.getProperty(b),g.uN(g.ys.bind(g),this,b,c,this),g.IG&&-1!==b.indexOf(".")&&a.bc.LC(this,b,c,f,"external"))};b.getProperty=function(b){var c=a.rc.bn(b),f=a.$.Ta(this),f=a.$.Hm(b,a.$.Pk(f));return c||!f||-1===b.indexOf(".")?this[b]:a.$.CY(this,
b)};b._propsProto.setProperty=function(b,c){if(a.$.Hm(b,a.$.Pk(this.Js))){var f=this.getProperty(b);this.Js.uN(this.Js.ys.bind(this.Js),this,b,c,this.iy);-1!==b.indexOf(".")&&a.bc.LC(this.iy,b,c,f,"internal")}else this.iy[b]=c};b._propsProto.getProperty=function(b){return a.$.Hm(b,a.$.Pk(this.Js))&&-1!==b.indexOf(".")?a.$.CY(this,b):this[b]};b.getNodeBySubId=function(b){var c=a.$.Ta(this);return c.By.getNodeBySubId?c.By.getNodeBySubId(b,c.via.bind(this)):c.via.bind(this)(b)};b.getSubIdByNode=function(b){var c=
a.$.Ta(this);return c.By.getSubIdByNode?c.By.getSubIdByNode(b,c.Uia.bind(this)):c.Uia.bind(this)(b)}},CM:function(b){if(this.qy){var c=this;this.$ya=this.qy.then(function(b){return a.mh.$E(b,"activatedMethod",[c.mO])})}this.$X.zF(this.ug);var e={},f=a.mh.MWa(b),g;for(g in f)e[g]=f[g].length;this.UBa=f;this.hca.zF(e);c=this;Promise.all([this.Nca,this.qy,this.$X.yA(),this.sza,this.$ya]).then(function(f){f=f[0];if(!f)throw this.vi(),"ojComposite is missing a View";var g={props:c.ug,a1a:c.UBa,b1a:e,unique:c.mO.unique,
uniqueId:c.mO.uniqueId,Gx:c.By,Uwa:c.mO};Object.defineProperty(b,a.gf.Oca,{value:"knockout"});a.mh.n0a(g,b,f);c.IG=!0;c.vi();a.bc.Vy("ready",b)})},fW:function(b,c,e){b[c]=function(){var b=e.internalName||c,g=a.$.Ta(this);return g.By[b].apply(g.By,arguments)}},FM:function(b,c,e){function f(b){var f=a.bc.Gia(this.Js,c);b=b?f.peek():f();void 0===b&&(b=e.value,"object"===typeof b?b=a.tc.Gd({},b,void 0,!0):Array.isArray(b)&&(b=b.slice()),f(b));return b}function g(a){k.bind(this)(a,!1)}function k(b,f){var g=
a.bc.Gia(this.Js,c),h=g.peek();h!==b&&(f&&(b=this.Js.IB(this.iy,c,b)),g(b),e.UH&&(g=a.rc.bn(c),h&&this.iy.removeEventListener(g,h),b&&(b instanceof Function?this.iy.addEventListener(g,b):a.$.fC(this,c,b,"function"))),!e.fP&&(!f||f&&this.Js.IG)&&a.bc.LC(this.iy,c,b,h,f?"external":"internal"))}e.fP||a.bc.Pfa(b._propsProto,c,function(){return f.bind(this,!1)()},g);a.bc.Pfa(b,c,function(){var b=a.$.Ta(this);return f.bind(b.ug,!0)()},function(b){var f=a.$.Ta(this);if(e.readOnly)throw f.vi(),"Read-only property "+
c+" cannot be set on "+this.tagName;k.bind(f.ug)(b,!0)})},QF:function(a){return a._metadata},p$:function(b){this.qy&&this.qy.then(function(c){a.mh.$E(c,"disposeMethod",[b])})},SF:function(b){a.$.kh.SF.call(this,b);this.qy&&this.qy.then(function(c){a.mh.$E(c,"detachedMethod",[b])})},Xx:function(b){a.$.kh.Xx.call(this,b);a.bc.Vy("pending",b);var c=a.$.sO(b.tagName);this.eN=c.parseFunction;b._propsProto&&(this.ug=Object.create(b._propsProto),this.ug.Js=this,this.ug.iy=b);this.$X=new a.$.rO;this.hca=
new a.$.rO;var e={element:b,props:this.$X.yA(),slotNodeCounts:this.hca.yA(),unique:a.bc.wKa()};e.uniqueId=b.id?b.id:e.unique;this.mO=e;var f=a.bc.gQ(c,"viewModel",this);if(f){var g=this;this.qy=f.then(function(b){b="function"===typeof b?new b(e):a.mh.$E(b,"initializeMethod",[e])||b;return g.By=b})}var k=a.$.sCa(b.tagName);if(k.view)this.Nca=Promise.resolve(a.bc.n0(k.view));else if(f=a.bc.gQ(c,"view",this))this.Nca=f.then(function(b){"string"===typeof b&&(b=a.bc.n0(b));k.view=b;return a.bc.n0(k.view)});
!k.css&&(c=a.bc.gQ(c,"css",this))&&(k.css=c.then(function(a){var b=document.createElement("style");b.type="text/css";b.styleSheet?b.styleSheet.cssText=a:b.appendChild(document.createTextNode(a));document.head.appendChild(b)}));this.sza=k.css;a.$.DY(b,this.ug,this.eN);this.PM().zF()},t$:function(a){Object.defineProperty(a,"_propsProto",{value:{}})},via:function(b){var c=a.bc.uCa(this)[b.subId];return c?c.alias?(b=a.tc.Gd({},b,void 0,!0),b.subId=c.alias,c=c.node,c.getNodeBySubId?c.getNodeBySubId(b):
a.Components.ud(c)("getNodeBySubId",b)):c.node:null},Uia:function(b){if(!this.contains(b))return null;var c=a.bc.tCa(this),e=a.gf.ksa(b,this);if(null!=e){var f=e.mn.getAttribute("data-oj-subid-map");return(c=c[f])&&e.getSubIdByNode&&(b=e.getSubIdByNode(b))?(b.subId=c.map[b.subId],b):null}for(e=b;e!==this&&!(f=e.getAttribute("data-oj-subid-map")||e.getAttribute("data-oj-subid"));)e=e.parentNode;if(c=c[f])if(c.map){if(f=c.node,b=f.getSubIdByNode?f.getSubIdByNode(b):a.Components.ud(f)("getSubIdByNode",
b))return b.subId=c.map[b.subId],b}else return{subId:f};return null}});a.bc.register=function(b,c){a.$.Tca(b,c,a.bc.kh,!0)&&a.bc.getMetadata(b).then(function(e){var f=e.name;f?b!=f&&a.D.warn("Registered property tagName: %s does not match name: %s provided in metadata.",b,f):a.D.warn('Required property "name" missing from metadata for %s.',b);e.version||a.D.warn('Required property "version" missing from metadata for %s.',b);e.jetVersion||a.D.warn('Required composite "jetVersion" missing from metadata for %s.',
b);c._metadata=a.$.Sca(e,!1);customElements.define(b.toLowerCase(),a.bc.kh.ZK(c))})};a.bc.getMetadata=function(b){var c=a.$.sO(b);if(c){var e=c._metadataPromise;e||(e=a.bc.gQ(c,"metadata",null),e||(a.D.warn("Required metadata is missing for "+b),e=Promise.resolve({})),c._metadataPromise=e);return e}return null};a.bc.Pfa=function(a,c,e,f){Object.defineProperty(a,c,{enumerable:!0,get:e,set:f})};a.bc.Vy=function(a,c){c.dispatchEvent(new CustomEvent(a,{bubbles:!0}))};a.bc.LC=function(a,c,e,f,g){var k=
{},l=c.split("."),m=c,p=e,t=f;1<l.length&&(m={},m.path=c,m.value=e,m.previousValue=f,k.subproperty=m,m=l[0],t=p=a[m]);k.value=p;k.previousValue=t;k.updatedFrom=g;a.dispatchEvent(new CustomEvent(m+"-changed",{detail:k}));a.dispatchEvent(new CustomEvent(m+"Changed",{detail:k}))};a.bc.n0=function(b){if("string"===typeof b){var c=document.createElement("div");c.innerHTML=b;b=[];for(var e=0;e<c.childNodes.length;e++)b.push(c.childNodes[e]);return b}if(a.bc.YNa(b)){c=b.cloneNode(!0);b=[];for(e=0;e<c.childNodes.length;e++)b.push(c.childNodes[e]);
return b}if(Array.isArray(b)){c=[];for(e=0;e<b.length;e++)c.push(b[e].cloneNode(!0));return c}a.$.Ta(this).vi();throw"The View ("+b+") has an unsupported type";};a.bc.$ga=function(b,c){if(!b.kca){for(var e={},f={},g=c.children,k=0;k<g.length;k++)a.bc.Jqa(e,f,g[k]);b.$Aa=f;b.kca=e}};a.bc.Jqa=function(b,c,e){if(!e.hasAttribute("slot")&&(a.bc.fDa(b,c,e),!a.$.zA(e.tagName)&&!a.Components.ud(e))){e=e.children;for(var f=0;f<e.length;f++)a.bc.Jqa(b,c,e[f])}};a.bc.fDa=function(a,c,e){var f=e.getAttribute("data-oj-subid"),
g=e.getAttribute("data-oj-subid-map");if(g){if(f=JSON.parse(g),"object"===typeof f&&!(f instanceof Array)){var k={},l;for(l in f)a[l]={alias:f[l],node:e},k[f[l]]=l;c[g]={map:k,node:e}}}else f&&(a[f]={node:e},c[f]={node:e})};a.bc.uCa=function(b){var c=a.$.Ta(b);a.bc.$ga(c,b);return c.kca};a.bc.tCa=function(b){var c=a.$.Ta(b);a.bc.$ga(c,b);return c.$Aa};a.bc.Gia=function(b,c){b.hO||(b.hO={});b.hO[c]||(b.hO[c]=a.mh.bXa());return b.hO[c]};a.bc.gQ=function(a,c,e){var f=null;a=a[c];if(null!=a)if(a.hasOwnProperty("inline"))f=
Promise.resolve(a.inline);else if(a.hasOwnProperty("promise"))f=a.promise;else throw e&&e.vi(),"Invalid descriptor key '"+Object.keys(a)[0]+"' for the resource type: "+c;return f};a.bc.wKa=function(){return c+g++};a.bc.YNa=function(a){return window.DocumentFragment?a instanceof DocumentFragment:a&&11===a.nodeType};var g=0,c="_ojcomposite";a.gf={};a.gf.Hd={initializeMethod:"initialize",activatedMethod:"activated",attachedMethod:"attached",bindingsAppliedMethod:"bindingsApplied",detachedMethod:"detached",
disposeMethod:"dispose"};o_("Composite.defaults",a.gf.Hd,a);a.gf.getMetadata=function(b){return a.bc.getMetadata(b)};o_("Composite.getMetadata",a.gf.getMetadata,a);a.gf.register=function(b,c){a.bc.register(b,c)};o_("Composite.register",a.gf.register,a);a.gf.ksa=function(b,c){for(var e=null;b;)if(b=a.mh.SXa(b)){if(c&&!(b.compareDocumentPosition(c)&16))break;e=b}return e};a.gf.IXa=function(b){return b?b[a.gf.Oca]:null};a.gf.Pca="__oj_composite";a.gf.Oca="__oj_binding_prvdr"});
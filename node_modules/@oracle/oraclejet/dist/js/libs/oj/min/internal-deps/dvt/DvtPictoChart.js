/**
 * Copyright (c) 2014, 2016, Oracle and/or its affiliates.
 * The Universal Permissive License (UPL), Version 1.0
 */
"use strict";
define(['./DvtToolkit'], function(dvt) {
  // Internal use only.  All APIs and functionality are subject to change at any time.

var ga;function ka(a,F){0==a.indexOf("dvt.")&&(a=a.substring(4));var D=a.split("."),E=eval("dvt");D[0]in E||!E.execScript||E.execScript("var "+D[0]);for(var v;D.length&&(v=D.shift());)D.length||void 0===F?E=E[v]?E[v]:E[v]={}:E[v]=F}Math.floor(2147483648*Math.random()).toString(36);
(function(a){function F(c,h,f,p,v,y,m){F.C.Init.call(this,c.a,"none"==h?null:h,a.j.Qg,f,p,v,y,null,!0,m);this.Ki=c}function D(a){this.Init(a)}function E(a,c){this.Init(a,c)}function v(a,c,f,p,x,y,m,z,w,A){v.C.Init.call(this,a.a,c,f,p,x,null,y,m,z,w,A);this.Ki=a}function x(){this.Init({alta:x.If})}function f(a){this.Init(a.a,a.dispatchEvent,a);this.Ki=a}function c(a){this.Ki=a}a.ui=function(a,c,f){this.Init(a,c,f)};a.f.v(a.ui,a.ec);a.ui.newInstance=function(c,h,f){return new a.ui(c,h,f)};a.ui.prototype.Init=
function(c,h,t){a.ui.C.Init.call(this,c,h,t);this.u=new f(this);this.u.Lf(this);a.m.eb()||this.u.Zr(new D(this.u));this.Ff=new x;this.Ob=[]};a.ui.prototype.xG=function(c,h){if(!c||!h){var f=p.Fn(this,c,h);this.Jma=f;c||(c=f.items?f.IGa*f.Paa:0);h||(h=f.items?f.GKa*f.Pca:0)}return new a.eg(c,h)};a.ui.prototype.ia=function(c,h,f){this.Ji=this.ha;var u=this.bu,v=this.Oa?this.Oa:0,y=this.bb?this.bb:0;this.u.ed();this.Ob=[];this.bu=[];this.Jma=null;this.jk&&(this.ha.removeChild(this.jk),this.jk=null);
this.Vq();this.me(c);var m=this.a;if(h||f)this.Oa=h,this.bb=f;else if(m.Qc.style.display="block",h=this.xG(),a.l.UV(m,h.b,h.i),f=a.l.Lba(m),h.b==f.b&&h.i!=f.i?(this.bb=f.i,h=this.xG(null,this.bb),a.l.UV(m,h.b,this.bb),this.Oa=a.l.Lba(m).b):h.b!=f.b&&h.i==f.i?(this.Oa=f.b,h=this.xG(this.Oa,null),a.l.UV(m,this.Oa,h.i),this.bb=a.l.Lba(m).i):(this.Oa=f.b,this.bb=f.i),this.Oa!=h.b||this.bb!=h.i)this.Jma=null;this.ha=new a.ca(m);this.B(this.ha);p.ia(this,this.ha,new a.U(0,0,this.Oa,this.bb),this.Jma);this.Ji?
"none"!=this.J.animationOnDataChange&&c&&(c=new a.Ql(m,null),c.En(u,this.bu),this.Cb=c.vz()):this.Cb=this.cWa();this.Cb?(a.l.UV(m,Math.max(v,this.Oa),Math.max(y,this.bb)),this.u.ln(this),this.jk&&this.ha.removeChild(this.jk),this.Cb.pg(this.P$,this),this.Cb.play()):this.P$()};a.ui.prototype.me=function(c){c?this.J=this.Ff.no(c):this.J||(this.J=this.dA());a.m.Il()||(this.J.animationOnDisplay="none",this.J.animationOnDataChange="none");c=this.J.selectionMode;this.Fd="single"==c?new a.Gb(a.Gb.hv):"multiple"==
c?new a.Gb(a.Gb.os):null;this.u.Fy(this.Fd)};a.ui.prototype.P$=function(){this.Ji&&(this.removeChild(this.Ji),this.Ji.Ec(),this.Ji=null);this.Cb&&(this.u.Lf(this),this.jk&&this.ha.B(this.jk));a.l.UV(this.a,this.Oa,this.bb);for(var c,h=0;h<this.Ob.length&&(c=this.Ob[h],"none"==c.yg());h++);this.u.Xr(c);this.Fd&&this.Fd.Vr(this.J.selection,this.Ob);a.sd.Zd(this.J.highlightedCategories,this.Ob,"any"==this.J.highlightMatch);this.ps();this.Bj||this.nl();this.Cb=null;this.Bj=!1};a.ui.prototype.Ava=function(a){this.Ob=
a};a.ui.prototype.gy=function(){return this.Ob};a.ui.prototype.D6a=function(a){this.bu.push(a)};a.ui.prototype.C6a=function(a){this.jk=a};a.ui.prototype.l4a=function(){for(var a=0,c=0;c<this.Ob.length;c++)a+=this.Ob[c].VU();return a};a.ui.prototype.Kb=function(){return a.$a.Aq(this.J.animationDuration)/1E3};a.ui.prototype.cWa=function(){var c=this.J.animationOnDisplay,h=this.Kb(),f=this.a,u=new a.U(0,0,this.Oa,this.bb);if(a.Sa.isSupported(c))return a.Sa.YD(f,c,this.ha,u,h);var v=[];if("popIn"==c)for(c=
0;c<this.bu.length;c++){var y=this.bu[c];v.push(new a.qk(f,y,!0,h))}else if("none"!=c){for(c=0;c<this.bu.length;c++){var y=this.bu[c],m=new a.td(f,y,h),z,w;p.Ea(this)?(z=p.jua(this)?this.Oa:0,w=y.Jg(),y.Zp(z),m.da.aa(a.L.ta,y,y.Jg,y.Zp,w)):(z=p.iua(this)?this.bb:0,w=y.Kg(),y.$p(z),m.da.aa(a.L.ta,y,y.Kg,y.$p,w));v.push(m)}v.push(a.Sa.YD(f,a.Sa.Vz,this.ha,u,h))}return 0<v.length?new a.$d(f,v):null};a.ui.prototype.Zd=function(c){var h=this.A();h.highlightedCategories=a.cb.clone(c);a.sd.Zd(c,this.gy(),
"any"==h.highlightMatch)};a.ui.prototype.select=function(c){this.A().selection=a.cb.clone(c);this.Fd&&this.Fd.Vr(c,this.gy())};a.ui.prototype.vk=function(){return a.I.Zc(this.A(),"componentName",a.I.pa,"PICTOCHART")};a.ui.prototype.Bi=function(){this.pBa||(this.pBa=new c(this));return this.pBa};a.f.v(c,a.Lc);c.prototype.Rl=function(a){return(a=this.Ki.Nb().Za(a))&&a instanceof E?"item["+this.Ki.gy().indexOf(a)+"]":null};c.prototype.Rh=function(c){if(c==a.Lc.Ew)return this.eA(this.Ki);var h=c.indexOf("[");
return 0<h&&"item"===c.substring(0,h)&&(c=this.Ki.gy()[parseInt(c.substring(h+1,c.length-1))])?c.ja():null};c.prototype.getItem=function(a){if(a=this.Ki.gy()[a]){var c={};c.color=a.pi();c.tooltip=a.bf();c.id=a.getId();c.name=a.getName();c.count=a.VU();c.selected=a.hb();return c}return null};c.prototype.l4=function(){return this.Ki.gy().length};a.f.v(f,a.u);f.prototype.Ij=function(c,h,f){c=this.Ki.A();"none"!=c.hoverBehavior&&(h=h.rd?h.rd():[],c.highlightedCategories=f?h.slice():null,f=a.la.MI(c.highlightedCategories,
f),h=a.$a.Aq(c.hoverBehaviorDelay),this.pF.Ef(f,this.Ki.gy(),h,"any"==c.highlightMatch))};f.prototype.iF=function(a){if(a=this.Za(a.target))this.Mz(a),a.gb&&a.gb()||this.Ay(a)};f.prototype.DJ=function(a){(a=this.Za(a.target))&&a.gb&&a.gb()&&this.Ay(a)};f.prototype.xM=function(a){if(a=this.Za(a.target))this.Mz(a),a.gb&&a.gb()||this.Ay(a)};f.prototype.cv=function(a){if(a=this.Za(a.target))this.Mz(a),a.gb&&a.gb()||this.Ay(a)};f.prototype.wM=function(a){var c=this.Za(a.target);c&&c.gb&&c.gb()&&(a.preventDefault(),
a.stopPropagation(),this.Ay(c))};f.prototype.Ay=function(c){c instanceof E&&c.bk()&&this.jt(a.la.xV(c.getId()))};f.prototype.Mz=function(c){c&&c.oh&&c.oh()&&this.jt(a.la.yy("action",c.oh(),c.getId()))};a.f.v(x,a.ka);x.If={animationOnDisplay:"none",animationOnDataChange:"none",animationDuration:750,drilling:"off",hiddenCategories:[],highlightedCategories:[],highlightMatch:"all",hoverBehavior:"none",hoverBehaviorDelay:200,layout:"horizontal",layoutOrigin:"topStart",selection:[],selectionMode:"none",
_defaultColor:"#a6acb1",_noneShapeColor:"rgba(255,255,255,0)",_defaultSize:32,_defaultShape:"rectangle",_gapRatio:.25,_textStyle:new a.j(a.ka.JW+"color: #252525;"),_statusMessageStyle:new a.j(a.ka.JW+"color: #252525;"),_tooltipStyle:new a.j("border-collapse: separate; border-spacing: 1px"),_tooltipLabelStyle:new a.j("color: #666666; padding: 0px 2px"),_tooltipValueStyle:new a.j("color: #333333; padding: 0px 2px")};a.f.v(v,a.xc);v.prototype.Mf=function(c,h){var f=new a.td(this.a,this,.75*this.Ki.Kb()),
p=f.da,v=this.Ek();this.im(h.Ek());p.aa(a.L.Hf,this,this.Ek,this.im,v);h.qa(0);c.add(f,1)};v.prototype.ai=function(c){c.add(new a.Vg(this.a,this,.5*this.Ki.Kb()),0)};v.prototype.mh=function(c){this.qa(0);c.add(new a.dg(this.a,this,.5*this.Ki.Kb()),2)};v.prototype.Ek=function(){return[this.Jg(),this.Kg(),this.getWidth(),this.getHeight()]};v.prototype.im=function(a){this.Zp(a[0]);this.$p(a[1]);this.kb(a[2]);this.Lb(a[3])};a.f.v(E,a.ca);E.ys=0;E.prototype.Init=function(c,h){E.C.Init.call(this,c.a,null,
h.id);this.Ki=c;this.zl=h;this.lc=null!=h.id?h.id:null!=h.name?h.name:"_defaultId"+E.ys;E.ys++;this.WO="none"==h.shape;this.Tc=this.wi=!1;this.iEa=new a.P(0,0);(this.gb()||this.bk())&&this.setCursor("pointer");c.Nb().Xb(this,this)};E.prototype.HHa=function(){var a=this.zl.columnSpan;return null!=a&&0<=a?Math.round(a):1};E.prototype.WIa=function(){var a=this.zl.rowSpan;return null!=a&&0<=a?Math.round(a):1};E.prototype.VU=function(){var a=this.zl.count;return null!=a?Math.max(a,0):1};E.prototype.yg=
function(){return this.zl.shape||this.Ki.A()._defaultShape};E.prototype.Zb=function(){return this.WO?this.Ki.A()._noneShapeColor:this.zl.color||this.Ki.A()._defaultColor};E.prototype.po=function(){return this.zl.borderColor};E.prototype.Qh=function(){return this.zl.borderWidth};E.prototype.Ir=function(){return this.zl.className||this.zl.svgClassName};E.prototype.N=function(){return this.zl.style||this.zl.svgStyle};E.prototype.cJa=function(){return this.zl.source};E.prototype.a4a=function(){return this.zl.sourceSelected};
E.prototype.Z3a=function(){return this.zl.sourceHover};E.prototype.$3a=function(){return this.zl.sourceHoverSelected};E.prototype.getName=function(){return this.zl.name};E.prototype.getId=function(){return this.lc};E.prototype.oh=function(){return this.zl.action};E.prototype.Dh=function(){return this.zl.shortDesc};E.prototype.bk=function(){if(this.WO)return!1;var a=this.zl.drilling;return a&&"inherit"!=a?"on"==a:"on"==this.Ki.A().drilling};E.prototype.Wp=function(){return this.gb()&&this.bk()&&!this.WO};
E.prototype.Z8a=function(){this.zg("img");this.So()};E.prototype.bf=function(){if(this.WO)return"";var c=this.Ki.A(),h=this.Ki.A().tooltip;if(h=h?h.renderer:null){var c=this.Ki.a.cf(),f={id:this.getId(),name:this.getName(),count:this.VU(),color:this.Zb()};return c.Rs(h,f)}if(null!=this.Dh())return this.Dh();h="";(f=this.getName())&&(h=a.Qb.AQ("td",c._tooltipLabelStyle)+f+"\x3c/td\x3e");f=a.m.ea(this.Ki.a);c._tooltipLabelStyle.Na(a.j.ZM,f?"left":"right");c._tooltipValueStyle.Na(a.j.ZM,f?"right":"left");
return a.Qb.AQ("table",c._tooltipStyle)+"\x3ctr\x3e"+h+a.Qb.AQ("td",c._tooltipValueStyle)+this.Ala()+"\x3c/td\x3e\x3c/tr\x3e\x3c/table\x3e"};E.prototype.pi=function(){return this.Zb()};E.prototype.Ala=function(){return a.I.Zc(this.Ki.A(),"labelCountWithTotal",a.I.pa,"COUNT_WITH_TOTAL",[this.VU(),this.Ki.l4a()])};E.prototype.gb=function(){return"none"!=this.Ki.A().selectionMode&&!this.WO};E.prototype.hb=function(){return this.wi};E.prototype.gc=function(a){this.wi=a;this.So();for(var c=0;c<this.Vc();c++){var f=
this.dc(c);(f instanceof F||f instanceof v)&&f.gc(a)}};E.prototype.Rc=function(){for(var a=0;a<this.Vc();a++){var c=this.dc(a);(c instanceof F||c instanceof v)&&c.Rc()}};E.prototype.Cc=function(){for(var a=0;a<this.Vc();a++){var c=this.dc(a);(c instanceof F||c instanceof v)&&c.Cc()}};E.prototype.Xd=function(){return[this]};E.prototype.se=function(){var c=[],h=this.Ki.A();this.gb()&&c.push(a.I.Zc(h,this.hb()?"stateSelected":"stateUnselected",a.I.pa,this.hb()?"STATE_SELECTED":"STATE_UNSELECTED"));this.bk()&&
c.push(a.I.Zc(h,"stateDrillable",a.I.pa,"STATE_DRILLABLE"));h=this.getName();h=null!=this.Dh()?this.Dh():null==h?this.Ala():a.I.Ja(a.I.pa,"COLON_SEP_LIST",[h,this.Ala()]);return a.R.mm(h,c)};E.prototype.So=function(){a.m.Vj()||this.Od("label",this.se())};E.prototype.rd=function(){return this.zl.categories||[this.getId()]};E.prototype.Kd=function(c){var h=this.Ki.Nb().ya;return c.type==a.MouseEvent.He||h.yo(c)?this:h.Th(c)?D.Kd(this.Ki,this,c):null};E.prototype.md=function(a){return this.V(a)};E.prototype.$j=
function(){return this.ja()};E.prototype.qh=function(){this.WO||(this.Tc=!0,this.Rc())};E.prototype.mf=function(){this.WO||(this.Tc=!1,this.Cc())};E.prototype.Ae=function(){return this.Tc};E.prototype.X7a=function(a){this.iEa=a};E.prototype.aV=function(){return this.iEa};a.f.v(D,a.ya);D.prototype.Iz=function(a){return this.Th(a)&&!a.ctrlKey};D.prototype.yo=function(c){return c.keyCode==a.KeyboardEvent.Kj&&c.ctrlKey};D.Kd=function(c,h,f,u){var v=c.gy();u||(u=h);if("none"==h.yg()&&h!=u){var y=a.Y.$b(v,
h);if(0==y||y==v.length-1)return u}var m=p.jua(c),z=p.iua(c),w=p.Ea(c),y=h,m=f.keyCode==a.KeyboardEvent.Ne&&m||f.keyCode==a.KeyboardEvent.Be&&!m||f.keyCode==a.KeyboardEvent.sg&&z||f.keyCode==a.KeyboardEvent.kf&&!z,w=f.keyCode==a.KeyboardEvent.Ne&&w||f.keyCode==a.KeyboardEvent.Be&&w||f.keyCode==a.KeyboardEvent.sg&&!w||f.keyCode==a.KeyboardEvent.kf&&!w,m=a.Y.$b(v,h)+(m?1:-1);w?y=a.ya.Kd(h,f,v):m<v.length&&0<=m&&(y=v[m]);"none"==y.yg()&&(y=y!=h?D.Kd(c,y,f,u):u);return y};D.prototype.Rk=function(c){var h=
this.Fc.Fe();return h&&c.keyCode==a.KeyboardEvent.Nn?(this.Fc.Ay(h),a.u.Ud(c),h):D.C.Rk.call(this,c)};a.f.v(F,a.W);F.prototype.Mf=function(c,h){var f=new a.td(this.a,this,.75*this.Ki.Kb()),p=f.da,v=this.Hd(),y=h.Hd().clone();y.mc(v)||(this.Ia(y),p.aa(a.L.yt,this,this.Hd,this.Ia,v));v=this.Ek();this.im(h.Ek());p.aa(a.L.Hf,this,this.Ek,this.im,v);h.qa(0);c.add(f,1)};F.prototype.ai=function(c){c.add(new a.Vg(this.a,this,.5*this.Ki.Kb()),0)};F.prototype.mh=function(c){this.qa(0);c.add(new a.dg(this.a,
this,.5*this.Ki.Kb()),2)};F.prototype.Ek=function(){return[this.Jg(),this.Kg(),this.getWidth(),this.getHeight()]};F.prototype.im=function(a){this.Zp(a[0]);this.$p(a[1]);this.kb(a[2]);this.Lb(a[3])};var p={};a.f.v(p,a.f);p.ia=function(c,h,f,u){var x=c.a,y=new a.Rect(x,f.x,f.y,f.b,f.i);y.Yb();h.B(y);u||(u=p.Fn(c,f.b,f.i));if(u.items){c.Ava(u.items);for(var y=c.A()._gapRatio*u.R5a,m=p.Ea(c),z=p.iua(c),w=p.jua(c),A=new a.dv,d=0,g=0,B=0,r=0;r<u.items.length;r++){var l=u.items[r],C=l.HHa(),K=l.WIa();if(!(0>=
C||0>=K)){for(var D=C*u.Paa,E=K*u.Pca,ca=l.VU(),ja=0,ea=!0,ha;0<ca;){if(C!=d||K!=g)B=0;0==B&&(ha=p.CCa(A,C,K,u.IGa,u.GKa,m));if(null==ha)break;var da=ha.Uqa*u.Paa+D/2,X=ha.Zva*u.Pca+E/2,da=f.x+(w?f.b-da:da),X=f.y+(z?f.i-X:X),aa=Math.min(1-B,ca),Y,P,R,T;m?(Y=da-D/2,P=z?X+E*(.5-aa-B):X+E*(B-.5),R=D,T=E*aa):(Y=w?da+D*(.5-aa-B):da+D*(B-.5),P=X-E/2,R=D*aa,T=E);var J;1==aa?(J=l.getId()+"_"+ja,ja++):J=Math.random();if(l.cJa())J=new v(c,da,X,D,E,l.cJa(),l.a4a(),l.Z3a(),l.$3a(),J+"_I");else{var W=new a.Rect(x,
Y,P,R,T);W.Yb();l.B(W);J=new F(c,l.yg(),da,X,D-u.Paa*y,E-u.Pca*y,J+"_S");J.ab(l.Zb());J.uc(l.po(),null,l.Qh());J.cS(l.Zb());J.sc(l.Ir());J.Na(l.N())}1>aa&&(W=new a.fc,W.qe(Y,P,R,T),J.be(W));ea&&(l.X7a(new a.P(da,X)),ea=!1);l.B(J);c.D6a(J);ca-=aa;B=(B+aa)%1}h.B(l);l.Z8a();d=C;g=K}}}else p.um(c,h,f)};p.Fn=function(c,h,f){var u=c.A(),v=u.items;if(!v)return{};for(var y=a.Y.VB(u.hiddenCategories),m=[],z=0,w=1,A=1,d=Infinity,g=0;g<v.length;g++)if(null!=v[g]){var B=new E(c,v[g]);if(!y||!a.Y.BI(y,B.rd())){var r=
B.HHa(),l=B.WIa();0>=r||0>=l||(r>w&&(w=r),l>A&&(A=l),r<d&&(d=r),l<d&&(d=l),z+=r*l*B.VU(),m.push(B))}}if(0==z)return{};v=u.columnWidth;y=u.rowHeight;h&&f||(v||(v=y?y:u._defaultSize),y||(y=v));c=p.Ea(c);g=u.columnCount;u=u.rowCount;g||u||(h&&f?c?u=p.FT(Math.sqrt(z*f/h),A):g=p.FT(Math.sqrt(z*h/f),w):h?g=Math.max(Math.floor(h/v),1):f?u=Math.max(Math.floor(f/y),1):c?u=p.FT(Math.sqrt(z),A):g=p.FT(Math.sqrt(z),w));g?u||(u=p.FT(z/g,A)):g=p.FT(z/u,w);h&&f&&(v||(v=y?y:Math.min(h/g,f/u)),y||(y=v));return 0>=
g||0>=u||0>=v||0>=y?{}:{items:m,IGa:g,GKa:u,Paa:v,Pca:y,R5a:d}};p.FT=function(a,c){return Math.ceil(a/c)*c};p.CCa=function(a,c,f,u,v,y){if(y)return(a=p.CCa(a,f,c,v,u,!1))?{Uqa:a.Zva,Zva:a.Uqa}:null;for(y=0;y<v-f+1;y++)for(var m=0;m<u-c+1;m++)if(p.ZTa(a,m,y,c,f))return p.UXa(a,m,y,c,f),{Uqa:m,Zva:y};return null};p.ZTa=function(a,c,f,p,v){for(var y=0;y<v;y++)for(var m=0;m<p;m++)if(a.get(c+m,f+y))return!1;return!0};p.UXa=function(a,c,f,p,v){for(var y=0;y<v;y++)for(var m=0;m<p;m++)a.put(c+m,f+y,!0)};
p.um=function(c,h,f){var p=c.A(),v=a.I.Zc(p,"labelNoData",a.I.pa,"NO_DATA");h=a.ga.um(h,v,f.clone(),c.Nb(),p._statusMessageStyle);c.C6a(h)};p.Ea=function(a){return"vertical"==a.A().layout};p.iua=function(a){a=a.A().layoutOrigin;return"bottomStart"==a||"bottomEnd"==a};p.jua=function(c){var h=c.A().layoutOrigin,h="topEnd"==h||"bottomEnd"==h;return a.m.ea(c.a)?!h:h};a.K(a,"PictoChart",a.ui);a.K(a.ui,"newInstance",a.ui.newInstance);a.K(a.ui.prototype,"destroy",a.ui.prototype.Ec);a.K(a.ui.prototype,"getAutomation",
a.ui.prototype.Bi);a.K(a.ui.prototype,"highlight",a.ui.prototype.Zd);a.K(a.ui.prototype,"render",a.ui.prototype.ia);a.K(a.ui.prototype,"select",a.ui.prototype.select);a.K(c.prototype,"getDomElementForSubId",c.prototype.Rh);a.K(c.prototype,"getItem",c.prototype.getItem);a.K(c.prototype,"getItemCount",c.prototype.l4)})(dvt);
  return dvt;
});

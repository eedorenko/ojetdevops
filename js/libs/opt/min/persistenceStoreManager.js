define(["./impl/logger"],function(a){"use strict";var b=function(){Object.defineProperty(this,"_stores",{value:{},writable:!0}),Object.defineProperty(this,"_factories",{value:{},writable:!0}),Object.defineProperty(this,"_DEFAULT_STORE_FACTORY_NAME",{value:"_defaultFactory",writable:!1})};return b.prototype.registerStoreFactory=function(a,b){if(!b)throw TypeError("A valid factory must be provided.");if(!a)throw TypeError("A valid name must be provided.");var c=this._factories[a];if(c&&c!==b)throw TypeError("A factory with the same name has already been registered.");this._factories[a]=b},b.prototype.registerDefaultStoreFactory=function(a){this.registerStoreFactory(this._DEFAULT_STORE_FACTORY_NAME,a)},b.prototype.openStore=function(b,c){a.log("Offline Persistence Toolkit PersistenceStoreManager: openStore() for name: "+b);var d=this._stores[b],e=c&&c.version||"0";if(d&&d[e])return Promise.resolve(d[e]);var f=this._factories[b];if(f||(f=this._factories[this._DEFAULT_STORE_FACTORY_NAME]),!f)return Promise.reject(new Error("no factory is registered to create the store."));var g=this;return a.log("Offline Persistence Toolkit PersistenceStoreManager: Calling createPersistenceStore on factory"),f.createPersistenceStore(b,c).then(function(a){return d=d||{},d[e]=a,g._stores[b]=d,a})},b.prototype.hasStore=function(a,b){var c=this._stores[a];return!!c&&(!b||!b.version||!!c[b.version])},b.prototype.deleteStore=function(b,c){a.log("Offline Persistence Toolkit PersistenceStoreManager: deleteStore() for name: "+b);var d=this._stores[b];if(d){var e=c&&c.version;if(e){var f=d[e];return f?(a.log("Offline Persistence Toolkit PersistenceStoreManager: Calling delete on store"),f.delete().then(function(){return delete d[e],!0})):Promise.resolve(!1)}var g=Object.keys(d).map(function(a){return function(b){return a[b].delete()}}(d),this),h=this;return Promise.all(g).then(function(){return delete h._stores[b],!0})}return Promise.resolve(!1)},new b});
//# sourceMappingURL=persistenceStoreManager.js.map
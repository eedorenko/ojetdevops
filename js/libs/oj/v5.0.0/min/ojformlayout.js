/**
 * @license
 * Copyright (c) 2014, 2018, Oracle and/or its affiliates.
 * The Universal Permissive License (UPL), Version 1.0
 */
"use strict";define(["ojs/ojcore","ojs/ojcomponentcore","ojs/ojlabel"],function(e){var t={properties:{direction:{type:"string",enumValues:["column","row"],value:"column"},labelEdge:{type:"string",enumValues:["start","top"],value:"top"},labelWidth:{type:"string",value:"33%"},labelWrapping:{type:"string",enumValues:["truncate","wrap"],value:"wrap"},maxColumns:{type:"number",value:1}},extension:{_CONSTRUCTOR:function(t){var o,i,a,r,l,d=this,s=t.element,u="-labelled-by",c="data-oj-formlayout-bonus-dom",m="["+c+"]",f=!0;function h(){i&&(i(),i=null)}function v(){o&&(o(),o=null)}function p(e){throw B(s),B(e),v(),h(),new Error("oj-form-layout component with id='"+s.id+"' has a child element "+e.tagName+" with id='"+e.id+"' that is not a supported child type.  See oj-form-layout tag documentation for more information.")}function b(t){var n=null;return t instanceof Element&&"labelHint"in t?(B(t),n=function(e){var t=document.createElement("oj-label");t.setAttribute(c,""),t.setAttribute("data-oj-internal",""),t.setAttribute("data-oj-binding-provider","none"),t.setAttribute("data-oj-context","");var n=document.createElement("span");return n.id=e.id+"|hint",n.textContent=e.labelHint,t.appendChild(n),function(e,t){"labelledBy"in t?(e.id=t.id+u,t.labelledBy=e.id):e.setAttribute("for",t.id)}(t,e),t}(t),t.parentElement.insertBefore(n,t),function(t,n){e.Context.getContext(n).getBusyContext().whenReady().then(function(){var e=t.helpHints;e&&(e.definition||e.source)&&(n.help=e),n.showRequired=t.required})}(t,n),function(e){e.addEventListener("labelHintChanged",g),e.addEventListener("helpHintsChanged",y),e.addEventListener("requiredChanged",C)}(t)):p(t),n}function g(e){var t=e.target,n=document.getElementById(t.id+"|hint");n&&(n.innerText=e.detail.value)}function y(e){var t=e.target,n=j(t);n&&(n.help=e.detail.value)}function C(e){var t=e.target,n=j(t);n&&(n.showRequired=e.detail.value)}function j(e){return"labelledBy"in e?document.getElementById(e.labelledBy):s.querySelector('oj-label[for="'+e.id+'"]')}function x(e,t,n){var o,i,a;o=n?E("oj-flex"):e.previousElementSibling,i=E("oj-flex-item"),o.appendChild(i),i.appendChild(e),i.style.webkitFlex="0 1 "+l,i.style.flex="0 1 "+l,i.style.maxWidth=l,i.style.width=l,a=E("oj-flex-item"),o.appendChild(a),t.parentElement.insertBefore(o,t),a.appendChild(t)}function E(e){var t=document.createElement("div");return t.setAttribute(c,""),t.setAttribute("data-oj-internal",""),t.classList.add(e),t}function L(e){for(var t=!0;e!==s;){if("OJ-FORM-LAYOUT"===e.tagName){t=!1;break}if(null==(e=e.parentElement)){t=!1;break}}return t}function w(e){for(;e.firstElementChild;)e.parentNode.insertBefore(e.firstElementChild,e);e.parentNode.removeChild(e)}function B(e){e.id||(e.id="oflId_"+n++)}d._rootElementMutationObserver=new MutationObserver(function(e){document.body.contains(s)?(!function(e){for(var t=e.length,n=0;n<t;n++){var o=e[n];if("attributes"===o.type&&"class"===o.attributeName){var i=r.indexOf(o.target);if(-1!==i&&o.target.classList.contains("oj-complete")){r.splice(i,1);var a=b(o.target);a&&x(a,o.target,o.target.hasAttribute("data-oj-needs-oj-flex-div"))}}}}(e),function(e){for(var t=e.length,n=0;n<t;n++){var o=e[n];if("childList"===o.type)for(var i=o.addedNodes.length,r=0;r<i;r++){var l=o.addedNodes[r];l.parentNode===s&&a.appendChild(l)}}}(e),function(e){for(var t=!0,n=e.length,o=0;o<n;o++){var i=e[o];if("childList"===i.type&&((a=i.target)===s||a&&"DIV"===a.tagName&&a.hasAttribute(c))&&L(i.target)){t=!1;break}}var a;return t}(e)||(!function(e){for(var t=e.length,n=0;n<t;n++){var o=e[n];if("childList"===o.type)for(var i=o.removedNodes.length,a=0;a<i;a++){var r=o.removedNodes[a];1===r.nodeType&&(r.removeEventListener("labelHintChanged",g),r.removeEventListener("helpHintsChanged",y),r.removeEventListener("requiredChanged",C))}}}(e),s.refresh())):this.disconnect()}),this.createDOM=function(){for(s.classList.add("oj-form-layout"),(a=document.createElement("div")).classList.add("oj-form"),a.setAttribute("data-oj-context",""),a.setAttribute("data-oj-internal",""),a.setAttribute(c,"");s.firstChild;)a.appendChild(s.firstChild);s.appendChild(a)},this.updateDOM=function(){!function(){if(!i){var t=e.Context.getContext(s).getBusyContext(),n={description:"The oj-form-layout component with id = '"+s.id+"' is being rendered."};i=t.addBusyState(n)}}(),r=[],l="start"===s.labelEdge?s.labelWidth:"100%";var t=e.Context.getContext(a).getBusyContext();t.whenReady().then(function(){!function(){if(!o){var t=e.Context.getContext(a).getBusyContext(),n={description:"The oj-form div for oj-form-layout component with id = '"+s.id+"' is being rendered."};o=t.addBusyState(n)}}(),d._rootElementMutationObserver.disconnect(),function(){var e=s.maxColumns;"start"===s.labelEdge?(a.classList.add("oj-form-cols-labels-inline"),a.classList.add("oj-formlayout-labels-inline"),a.classList.remove("oj-form-cols")):(a.classList.add("oj-form-cols"),a.classList.remove("oj-form-cols-labels-inline"),a.classList.remove("oj-formlayout-labels-inline"));"truncate"===s.labelWrapping?a.classList.add("oj-formlayout-labels-nowrap"):a.classList.remove("oj-formlayout-labels-nowrap");e="row"===s.direction?1:s.maxColumns;a.style.columnCount=e,a.style.webkitColumnCount=e,a.style.MozColumnCount=e}(),f||function(){for(var e=a.querySelectorAll(m),t=e.length,n=0;n<t;++n){var o=e[n];"OJ-LABEL"===o.tagName?o.parentElement.removeChild(o):w(o)}}(),function(){var e=a.firstElementChild,t=0,n="column"===s.direction;for(;e;){if(-1!==e.tagName.indexOf("-"))if("oj-label"===e.tagName.toLowerCase()){var o=e;if(!(e=e.nextElementSibling))throw B(s),B(o),v(),h(),new Error("oj-form-layout component with id='"+s.id+"' has an oj-label child element with id='"+o.id+"' but has no next sibling element that it is associated with.")}else e.classList.contains("oj-complete")?b(e):((n||t%s.maxColumns==0)&&e.setAttribute("data-oj-needs-oj-flex-div",""),r.push(e));else p(e);t++,e=e.nextElementSibling}}(),function(){var e,t=[],n=a.children.length,o="column"===s.direction,i=0,l=0;!function(e,t){var n=e.length;for(;n--;)t[n]=e[n]}(a.children,t);for(;i<n;)e=t[i],-1===r.indexOf(e)&&x(e,t[++i],o||l%s.maxColumns==0),l++,i++}(),d._rootElementMutationObserver.observe(s,{childList:!0,subtree:!0,attributes:!0}),v(),h(),f&&(f=!1)})}}}};Object.freeze(t);var n=0;e.CustomElementBridge.registerMetadata("oj-form-layout",null,t),e.CustomElementBridge.register("oj-form-layout",{metadata:e.CustomElementBridge.getMetadata("oj-form-layout")})});
/**
 * @license
 * Copyright (c) 2014, 2018, Oracle and/or its affiliates.
 * The Universal Permissive License (UPL), Version 1.0
 */
"use strict";define(["ojs/ojcore","jquery","ojs/ojeditablevalue","ojs/ojradiocheckbox","ojs/ojoption"],function(e,t){!function(){e.__registerWidget("oj.ojRadioset",t.oj.editableValue,{version:"1.0.0",defaultElement:"<div>",widgetEventPrefix:"oj",options:{disabled:!1,labelledBy:null,required:!1,value:void 0},refresh:function(){this._super(),this._setup()},widget:function(){return this.uiRadioset},validate:e.EditableValueUtils.validate,_InitOptions:function(t,i){var o,n;this._super(t,i),this._IsCustomElement()||(e.EditableValueUtils.initializeOptionsFromDom([{attribute:"disabled",validateOption:!0},{attribute:"required",coerceDomValue:!0,validateOption:!0},{attribute:"title"}],i,this),void 0===i.value&&(this.$radios=this._findRadiosWithMatchingName(),void 0!==(n=0===(o=this.$radios.filter(":checked")).length?void 0:o.val())&&this.option("value",n,{_context:{writeback:!0,internalSet:!0}}),void 0===this.options.value&&(this.options.value=null)))},_ComponentCreate:function(){var e=this.element;if(this._super(),e.uniqueId(),this._processOjOptions(),this.$radios=this._findRadiosWithMatchingName(),e.is("fieldset"))throw new Error("ojRadioset cannot be bound to a fieldset. Use a div instead.");this.$radios._ojRadioCheckbox().attr("data-oj-internal",""),this.uiRadioset=e.addClass("oj-radioset oj-component").attr("role","radiogroup"),t(e.get(0).childNodes).filter(function(){return!this.getAttribute||"contextMenu"!==this.getAttribute("slot")}).wrapAll("<div class='oj-radioset-wrapper'></div>"),this._on(this._events),this._setup()},_ResetComponentState:function(){this._processOjOptions(),this.$radios=this._findRadiosWithMatchingName(),this.$radios.filter(".oj-radio").each(function(){var e=void 0!==t(this).attr("disabled")&&!!t(this).prop("disabled");t(this)._ojRadioCheckbox("option","disabled",e)}),this.$radios.not(".oj-radio")._ojRadioCheckbox()},GetFocusElement:function(){return this._GetContentElement().filter(":focusable").first()[0]},_IsRequired:function(){return this.options.required},_SetDisabledDom:function(e){},_refreshRequired:e.EditableValueUtils._refreshRequired,_ValidateReturnBoolean:e.EditableValueUtils._ValidateReturnBoolean,_processOjOptions:function(){if(this._IsCustomElement()){var e,t,i=this._customOptionRenderer.bind(this),o=this.element.children("oj-option");for(e=0,t=o.length;e<t;e++)o[e].customOptionRenderer=i,this._initInputLabelFromOjOption(o[e]);if((o=this.element.children(".oj-radioset-wrapper").find("oj-option")).length>0)for(e=0,t=o.length;e<t;e++)o[e].customOptionRenderer=i,this._initInputLabelFromOjOption(o[e])}},_initInputLabelFromOjOption:function(e){var i,o,n=e;t(n).uniqueId();var a=n.getAttribute("id"),s=a+"|rb",r=document.getElementById(s);null!==r||(i=document.createElement("span"),r=document.createElement("input"),o=document.createElement("label"),i.setAttribute("class","oj-choice-item"),r.setAttribute("type","radio"),r.setAttribute("id",s),o.setAttribute("for",s),n.parentElement.insertBefore(i,n),o.appendChild(n),i.appendChild(r),i.appendChild(o));var d=this.element[0].id,l=n.getAttribute("aria-label"),u=n.getAttribute("aria-labelledby");r.setAttribute("data-oj-option-id",a),d&&""!=d&&r.setAttribute("name",d),l&&""!=l?r.setAttribute("aria-label",l):r.removeAttribute("aria-label"),u&&""!=u?r.setAttribute("aria-labelledby",u):r.removeAttribute("aria-labelledby"),n.disabled?r.setAttribute("disabled",!0):r.removeAttribute("disabled")},_customOptionRenderer:function(e){var i=e,o=i.getAttribute("id")+"|rb",n=document.getElementById(o);null!==n&&n.classList.contains("oj-radio")&&t(n)._ojRadioCheckbox("option","disabled",i.disabled)},_updateLabelledBy:e.EditableValueUtils._updateLabelledBy,_findRadiosWithMatchingName:function(){var t,i,o=this.element,n=o.find("input[type=radio]:first");return 0===n.length&&e.Logger.warn("Could not find any input type=radio within this element"),void 0===(t=n.attr("name"))?o.find("input[type=radio]").not("[name]"):(i="input[type=radio][name="+t+"]",o.find(i))},_NotifyContextMenuGesture:function(e,t,i){var o=this.element.find("input[type=radio]"),n=o.filter(":checked"),a=n.length?n:o.filter(":enabled").first();this._OpenContextMenu(t,i,{launcher:a})},_GetMessagingLauncherElement:function(){return this.widget()},_setup:function(){this._propagateDisabled(this.options.disabled),this.element.hasClass("oj-choice-direction-column")||this.element.hasClass("oj-choice-direction-row")||this.element.addClass("oj-choice-direction-column"),this._refreshRequired(this.options.required),this._updateLabelledBy(null,this.options.labelledBy,this.widget())},_events:{change:function(e){this._HandleChangeEvent(e)}},_HandleChangeEvent:function(e){var t=this._GetDisplayValue();this._SetValue(t,e,i)},_GetDisplayValue:function(e){return this._GetElementValue()},_SetDisplayValue:function(i){var o,n,a=this.$radios.length,s=-1,r=this.$radios.get(),d=[];for(o=0;o<a;o++)if(d[o]=this._GetOptionValue(r[o]),d[o]===i){s=o;break}if(-1===s)for(o=0;o<a;o++)if(e.Object.compareValues(d[o],i)){s=o;break}for(o=0;o<a;o++){var l=(n=t(this.$radios[o]))._ojRadioCheckbox("option","checked");o===s?l||n._ojRadioCheckbox("option","checked",!0):l&&n._ojRadioCheckbox("option","checked",!1)}},_GetElementValue:function(){var e=this.$radios.filter(":checked");return 0===e.length?null:this._GetOptionValue(e[0])},_GetOptionValue:function(e){var t,i;return this._IsCustomElement()?(t=document.getElementById(e.getAttribute("data-oj-option-id")))&&(i=t.value):i=e.value,i},_GetDefaultStyleClass:function(){return"oj-radioset"},_GetContentElement:function(){return null!=this.$radios?this.$radios:(this.$radios=this._findRadiosWithMatchingName(),this.$radios)},_AriaRequiredUnsupported:function(){return!0},_AfterSetOptionRequired:e.EditableValueUtils._AfterSetOptionRequired,_propagateDisabled:function(e){e=!!e,this.$radios.each(function(){t(this).data("oj-_ojRadioCheckbox").__setAncestorComponentDisabled(e)}),this.$radios._ojRadioCheckbox("refreshDisabled")},_setOption:function(e,t,i){var o=this.options.labelledBy;switch(this._super(e,t,i),e){case"disabled":this._propagateDisabled(t);break;case"labelledBy":this._updateLabelledBy(o,t,this.widget())}},_AfterSetOption:function(e,t,i){switch(this._superApply(arguments),e){case"required":this._AfterSetOptionRequired(e)}},getNodeBySubId:function(t){var i,o,n=this._super(t);if(!n)switch(i=this.$radios.get(),t.subId){case"oj-radioset-inputs":n=i;break;case"oj-radioset-radio":if(void 0!==(o=t.value)){for(var a=i.length,s=-1,r=[],d=0;d<a;d++)if(r[d]=this._GetOptionValue(i[d]),r[d]===o){s=d;break}if(-1===s)for(d=0;d<a;d++)if(e.Object.compareValues(r[d],o)){s=d;break}-1!==s&&(n=i[s])}}return n||null},getSubIdByNode:function(e){for(var t=this._GetContentElement()[0].parentElement.parentElement.parentElement,i=e;i&&i!=t;){if("LABEL"==i.nodeName&&(i=document.getElementById(i.for)),"INPUT"==i.nodeName)return{subId:"oj-radioset-radio",value:this._GetOptionValue(i)};i=i.parentElement}return this._super(e)},_destroy:function(){var e=this._super(),i=this.element[0].firstElementChild;return this.$radios&&this.$radios._ojRadioCheckbox("destroy"),t(i).contents().unwrap(),e}});var i={doValueChangeCheck:!1}}(),e.CustomElementBridge.registerMetadata("oj-radioset","editableValue",{properties:{disabled:{type:"boolean"},labelledBy:{type:"string"},required:{type:"boolean"},translations:{type:"Object",properties:{required:{type:"Object",properties:{hint:{type:"string"},messageDetail:{type:"string"},messageSummary:{type:"string"}}}}},value:{type:"any",writeback:!0}},methods:{validate:{}},extension:{_WIDGET_NAME:"ojRadioset"}}),e.CustomElementBridge.register("oj-radioset",{metadata:e.CustomElementBridge.getMetadata("oj-radioset")})});
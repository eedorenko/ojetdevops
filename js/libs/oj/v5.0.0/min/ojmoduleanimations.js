/**
 * @license
 * Copyright (c) 2014, 2018, Oracle and/or its affiliates.
 * The Universal Permissive License (UPL), Version 1.0
 */
"use strict";define(["ojs/ojcore","knockout","jquery","promise","ojs/ojanimation"],function(n,e,i){n.ModuleAnimations={},n.ModuleAnimations._addContainedElements=function(n,i){for(var t=e.virtualElements.firstChild(n);t;)1==t.nodeType?i.push(t):8==t.nodeType&&this._addContainedElements(t,i),t=e.virtualElements.nextSibling(t)},n.ModuleAnimations._cacheVirtualViewRoot=function(n,e){n._ojOldRoot=e},n.ModuleAnimations._getVirtualViewRoot=function(n){return n._ojOldRoot},n.ModuleAnimations._defaultCanAnimate=function(e){if(e.isInitial)return!1;if(1==e.node.nodeType)return!0;if(8==e.node.nodeType){var i=[];if(n.ModuleAnimations._addContainedElements(e.node,i),i&&1==i.length)return n.ModuleAnimations._cacheVirtualViewRoot(e,i[0]),!0}return!1},n.ModuleAnimations._getOldView=function(e){var i;return 1==e.node.nodeType?i=e.node:8==e.node.nodeType&&(i=n.ModuleAnimations._getVirtualViewRoot(e)),i},n.ModuleAnimations._createViewParent=function(n){var e=i(document.createElement("div")),t={position:"absolute",height:n.offsetHeight+"px",width:n.offsetWidth+"px",left:n.offsetLeft+"px",top:n.offsetTop+"px"};e.appendTo(n.offsetParent),e.css(t),e.addClass("oj-animation-host-viewport");var o=document.createElement("div");return o.className="oj-animation-host",e.append(o),o},n.ModuleAnimations.createAnimation=function(e,i,t){return{canAnimate:n.ModuleAnimations._defaultCanAnimate,prepareAnimation:function(o){var a={},l=n.ModuleAnimations._getOldView(o);return i&&!t&&(a.newViewParent=n.ModuleAnimations._createViewParent(l)),e&&(a.oldViewParent=n.ModuleAnimations._createViewParent(l)),i&&t&&(a.newViewParent=n.ModuleAnimations._createViewParent(l)),a},animate:function(t){var o=t.oldViewParent,a=t.newViewParent,l=[];return o&&e&&l.push(n.AnimationUtils.startAnimation(o,"close",e)),a&&i&&l.push(n.AnimationUtils.startAnimation(a,"open",i)),Promise.all(l).then(function(e){n.ModuleAnimations._postAnimationProcess(t)})}}},n.ModuleAnimations._removeViewParent=function(n,e){var i=n[e];if(i){var t=i.parentNode;t&&t.parentNode&&t.parentNode.removeChild(t)}},n.ModuleAnimations._postAnimationProcess=function(e){e.removeOldView(),e.insertNewView(),n.ModuleAnimations._removeViewParent(e,"newViewParent"),n.ModuleAnimations._removeViewParent(e,"oldViewParent")},n.ModuleAnimations._getModuleEffect=function(e){return null==n.ModuleAnimations._moduleEffects&&(n.ModuleAnimations._moduleEffects=n.ThemeUtils.parseJSONFromFontFamily("oj-animation-module-effects")),n.ModuleAnimations._moduleEffects?n.ModuleAnimations._moduleEffects[e]:null},n.ModuleAnimations._getImplementation=function(e){var i=n.ModuleAnimations._getModuleEffect(e);return i?n.ModuleAnimations.createAnimation(i.oldViewEffect,i.newViewEffect,i.newViewOnTop):null},n.ModuleAnimations._getNavigateMethod=function(e,i){return null==n.ModuleAnimations._navigateMethods&&(n.ModuleAnimations._navigateMethods=n.ThemeUtils.parseJSONFromFontFamily("oj-animation-navigate-methods")),n.ModuleAnimations._navigateMethods?n.ModuleAnimations._navigateMethods[i]:null},n.ModuleAnimations._navigateCanAnimate=function(e,i){var t=n.ModuleAnimations._getNavigateMethod(e,i);return!!n.ModuleAnimations[t]&&(null==n.ModuleAnimations[t].canAnimate||n.ModuleAnimations[t].canAnimate(e))},n.ModuleAnimations._navigatePrepareAnimation=function(e,i){var t=n.ModuleAnimations._getNavigateMethod(e,i);return n.ModuleAnimations[t]&&n.ModuleAnimations[t].prepareAnimation?n.ModuleAnimations[t].prepareAnimation(e):null},n.ModuleAnimations._navigateAnimate=function(e,i){var t=n.ModuleAnimations._getNavigateMethod(e,i);return n.ModuleAnimations[t]&&n.ModuleAnimations[t].animate?n.ModuleAnimations[t].animate(e):Promise.resolve()},n.ModuleAnimations._getNavigateImplementation=function(e){return{canAnimate:function(i){return n.ModuleAnimations._navigateCanAnimate(i,e)},prepareAnimation:function(i){return n.ModuleAnimations._navigatePrepareAnimation(i,e)},animate:function(i){return n.ModuleAnimations._navigateAnimate(i,e)}}},n.ModuleAnimations.coverLeft=n.ModuleAnimations._getImplementation("coverLeft"),n.ModuleAnimations.coverRight=n.ModuleAnimations._getImplementation("coverRight"),n.ModuleAnimations.revealLeft=n.ModuleAnimations._getImplementation("revealLeft"),n.ModuleAnimations.revealRight=n.ModuleAnimations._getImplementation("revealRight"),n.ModuleAnimations.coverStart="rtl"===n.DomUtils.getReadingDirection()?n.ModuleAnimations.coverRight:n.ModuleAnimations.coverLeft,n.ModuleAnimations.revealEnd="rtl"===n.DomUtils.getReadingDirection()?n.ModuleAnimations.revealLeft:n.ModuleAnimations.revealRight,n.ModuleAnimations.coverUp=n.ModuleAnimations._getImplementation("coverUp"),n.ModuleAnimations.revealDown=n.ModuleAnimations._getImplementation("revealDown"),n.ModuleAnimations.zoomIn=n.ModuleAnimations._getImplementation("zoomIn"),n.ModuleAnimations.zoomOut=n.ModuleAnimations._getImplementation("zoomOut"),n.ModuleAnimations.fade=n.ModuleAnimations._getImplementation("fade"),n.ModuleAnimations.pushStart=n.ModuleAnimations._getImplementation("pushStart"),n.ModuleAnimations.pushEnd=n.ModuleAnimations._getImplementation("pushEnd"),n.ModuleAnimations.navChild=n.ModuleAnimations._getNavigateImplementation("navChild"),n.ModuleAnimations.navParent=n.ModuleAnimations._getNavigateImplementation("navParent"),n.ModuleAnimations.drillIn=n.ModuleAnimations.navChild,n.ModuleAnimations.drillOut=n.ModuleAnimations.navParent,n.ModuleAnimations.navSiblingEarlier=n.ModuleAnimations._getNavigateImplementation("navSiblingEarlier"),n.ModuleAnimations.navSiblingLater=n.ModuleAnimations._getNavigateImplementation("navSiblingLater"),n.ModuleAnimations.switcher=function(e){return new function(){var i;function t(n){return function(e){return i[n].call(i,e)}}var o=this;this.canAnimate=function(a){var l=e(a);if(!(i=null==l?null:n.ModuleAnimations[l]))return!1;for(var m=["prepareAnimation","animate"],u=0;u<m.length;u++){var r=m[u];o[r]=t(r)}return t("canAnimate")(a)}}}});